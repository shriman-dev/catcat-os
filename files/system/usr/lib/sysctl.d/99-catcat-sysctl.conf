# Parameters by lynis audit
###################################
dev.tty.ldisc_autoload = 0

fs.protected_fifos = 2
fs.protected_regular = 2

kernel.kptr_restrict = 2

kernel.perf_event_paranoid = 3

kernel.sysrq = 0

kernel.unprivileged_bpf_disabled = 1

# Restricts process inspection to only parent processes
# 3 to completely disable process inspection
kernel.yama.ptrace_scope = 1

net.core.bpf_jit_harden = 2

net.ipv4.conf.*.accept_redirects = 0
net.ipv6.conf.*.accept_redirects = 0
net.ipv4.conf.*.send_redirects = 0

net.ipv4.conf.*.log_martians = 1

#net.ipv4.conf.*.rp_filter = 1


# Extra parameters
##########################
#fs.binfmt_misc.status = 0

# Disables direct I/O operations used for high-performance
# 1 to allows io_uring for specified gid
kernel.io_uring_disabled = 2
# Specify gid to allow direct I/O operations
#kernel.io_uring_group = 1000

# Prevents runtime loading of new kernel
kernel.kexec_load_disabled = 1

kernel.oops_limit = 10
#kernel.panic_on_oops = 1

# Automatically reboot 5 seconds after a kernel panic occurs
kernel.panic=5

# Implies consistent behavior of showing error messages in console during boot
kernel.printk = 3 3 3 3

#kernel.warn_limit = 80

# Restricts IPv6 socket to accept IPv6 traffic only
net.ipv6.bindv6only = 1

# Enables IPv6 privacy extension
net.ipv6.conf.*.use_tempaddr = 2

#net.ipv4.conf.*.arp_filter = 1
#net.ipv4.conf.*.arp_ignore = 2
#net.ipv4.conf.all.drop_gratuitous_arp = 1

net.ipv4.icmp_echo_ignore_all = 1
net.ipv6.icmp.echo_ignore_all = 1

#net.ipv4.tcp_rfc1337 = 1

